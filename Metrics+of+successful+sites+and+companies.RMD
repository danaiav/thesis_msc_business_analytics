---
title: "Spinellis"
author: "Danai Avratoglou"
date: "31 Οκτωβρίου 2016"
output: html_document
---

```{r}
#we upload the dataset
total_500 <- read.csv("F:/Dropbox/Dani/Spinellis - Diplwmatiki/Jupyter markdown/total_500.csv", sep=";")
#we see how many observations and how many variables we have and then the names of the variables we have
dim(total_500)
names(total_500)
str(total_500)

#We make the factors numbers where it is possible
total_500.sub <- total_500
total_500.sub$Assets.. <- gsub(",", ".", total_500.sub$Assets.. )
total_500.sub$Market.value.. <- gsub(",", ".", total_500.sub$Market.value.. )
total_500.sub$Revenues.. <- gsub(",", ".", total_500.sub$Revenues.. )
total_500.sub$Total.Stockholder.Equity.. <- gsub(",", ".", total_500.sub$Total.Stockholder.Equity.. )
num <- c(2,3,4,5,6,9,10,11,12,13,14,22,24,25,757:767)
for(i in 1:27){
  k <- num[i]
  total_500.sub[,k] <- as.numeric(as.character(total_500.sub[,k]))}  
str(total_500.sub)
#since we know that some pages where not downloaded we have to create a subset that we do not include those pages so as not to have n/a
not_downloadable_sites= c(15,64,86,90,97,118,131,135,141,161,164,216,239,242,275,306,326,363,397,414,416,441,455,464)
for (i in 1:24) {
  nds <- not_downloadable_sites[i]
  total_500.sub <- subset(total_500.sub, X != nds)
}
#we remove the extra value X since it is not necessary for the analysis
total_500.sub$X <- NULL
#we upload the libraries beneath that we will use in the analysis
library(ggplot2)
library(reshape2)
library(DAAG)
#We make the variables numeric in order to test them
total_500.sub[,766] <- as.numeric(total_500.sub[,766])
##########################################################################################################
#Firstly we will analyze the social media relevance with the sites.
total_500_social_media <- total_500.sub[,c(6,22,14,15,16,17,18,19)]
#We will see how many of the sites have social media and what type of social media
social_media_facebook <- table(total_500_social_media$facebook)
social_media_twitter <- table(total_500_social_media$twitter)
social_media_instagram <- table(total_500_social_media$instagram)
social_media_pinterest <- table(total_500_social_media$pinterest)
social_media_youtube <- table(total_500_social_media$youtube)
social_media_linkedin <- table(total_500_social_media$linkedin)
par(mfrow=c(2,3))
barplot(social_media_facebook,horiz = FALSE,col = "BLUE") + title ("Facebook link per company")
barplot(social_media_twitter,horiz = FALSE,col = "DARKGREEN") + title ("Twitter link per company")
barplot(social_media_instagram,horiz = FALSE,col = "PINK") + title ("Instagram link per company")
barplot(social_media_pinterest,horiz = FALSE,col = "RED") + title ("pinterest link per company")
barplot(social_media_youtube,horiz = FALSE,col = "DARKred") + title ("youtube link per company")
barplot(social_media_linkedin,horiz = FALSE,col = "DARKBLUE") + title ("linkedin link per company")
par(mfrow=c(1,1))
#########################################################################################################
#We will now check the links by creating an histogram
#Then we create tables in order to see in what frequency the links appear
social_media_external <- table(total_500.sub$external)
social_media_internal <- table(total_500.sub$internal)
social_media_total_links <- table(total_500.sub$total.links)
#Finally we create barplots to see the frequency
par(mfrow=c(3,1))
plot(social_media_external,col = "DARKRED") + title ("External links frequency")
barplot(social_media_internal,col = "DARKRED") + title ("Internal links frequency")
barplot(social_media_total_links,col = "DARKRED") + title ("Total links frequency")
#########################################################################################################
#Now we will see the loading time per site
par(mfrow=c(1,1))
loadtime <- table(total_500.sub$loading.time)
hist(loadtime,col = "DARKRED")
#########################################################################################################
#Now we will see the words in total and fo unique count
par(mfrow=c(2,1))
total_words <- table(total_500.sub$total_words)
u_words <- table(total_500.sub$unique_words)
plot(total_words,col = "DARKRED")
plot(u_words,col = "darkgreen")
#########################################################################################################
#Now we will see the readability of the sites
par(mfrow=c(1,1))
readability <- table(total_500.sub$Readability)
plot(readability,col = "DARKRED")
#########################################################################################################

