---
title: "Spinellis"
author: "Danai Avratoglou"
date: "31 Οκτωβρίου 2016"
output: html_document
---

```{r}
#we upload the dataset
total_500 <- read.csv("F:/Dropbox/Dani/Spinellis - Diplwmatiki/Jupyter markdown/total_500.csv", sep=";")
#we see how many observations and how many variables we have and then the names of the variables we have
dim(total_500)
names(total_500)
str(total_500)
#since we know that some pages where not downloaded we have to create a subset that we do not include those pages so as not to have n/a
total_500.sub <- total_500
not_downloadable_sites= c(15,64,86,90,97,118,131,135,141,161,164,216,239,242,275,306,326,363,397,414,416,441,455,464)
for (i in 1:24) {
  nds <- not_downloadable_sites[i]
  total_500.sub <- subset(total_500.sub, X != nds)
}
str(total_500.sub)
names(total_500.sub)
total_500.sub$X
#we remove the extra value X since it is not necessary for the analysis
total_500.sub$X <- NULL
#we upload the libraries beneath that we will use in the analysis
library(ggplot2)
library(reshape2)
library(DAAG)
#We make the variables numeric in order to test them
total_500.sub[,766] <- as.numeric(total_500.sub[,766])
##########################################################################################################
#Firstly we will analyze the social media relevance with the sites.
total_500_social_media <- total_500.sub[,c(6,22,14,15,16,17,18,19)]
#We will see how many of the sites have social media and what type of social media
social_media_facebook <- table(total_500_social_media$facebook)
social_media_twitter <- table(total_500_social_media$twitter)
social_media_instagram <- table(total_500_social_media$instagram)
social_media_pinterest <- table(total_500_social_media$pinterest)
social_media_youtube <- table(total_500_social_media$youtube)
social_media_linkedin <- table(total_500_social_media$linkedin)
par(mfrow=c(2,3))
barplot(social_media_facebook,horiz = FALSE,col = "BLUE") + title ("Facebook link per company")
barplot(social_media_twitter,horiz = FALSE,col = "DARKGREEN") + title ("Twitter link per company")
barplot(social_media_instagram,horiz = FALSE,col = "PINK") + title ("Instagram link per company")
barplot(social_media_pinterest,horiz = FALSE,col = "RED") + title ("pinterest link per company")
barplot(social_media_youtube,horiz = FALSE,col = "DARKred") + title ("youtube link per company")
barplot(social_media_linkedin,horiz = FALSE,col = "DARKBLUE") + title ("linkedin link per company")
par(mfrow=c(1,1))
#########################################################################################################
#We will now check the links by creating an histogram
#First we need to convert the variables for factors to integers
total_500.sub$external <- as.numeric(as.character(total_500.sub$external))
total_500.sub$internal <- as.numeric(as.character(total_500.sub$internal))
total_500.sub$total.links <- as.numeric(as.character(total_500.sub$total.links))
#Then we create tables in order to see in what frequency the links appear
social_media_external <- table(total_500.sub$external)
social_media_internal <- table(total_500.sub$internal)
social_media_total_links <- table(total_500.sub$total.links)
#Finally we create barplots to see the frequency
par(mfrow=c(3,1))
barplot(social_media_external,col = "DARKRED") + title ("External links frequency")
barplot(social_media_internal,col = "DARKRED") + title ("Internal links frequency")
barplot(social_media_total_links,col = "DARKRED") + title ("Total links frequency")
```
