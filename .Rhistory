par(mfrow=c(1,1))
plot(full_3,which=1:3)
blassob <- coef(lassob, s="lambda.1se")
blassob
zblassob <- blassob[-1] * apply(x,2,sd)
zboltb <- coef (full_2) [-1] * apply (x,2,sd)
s <- sum(abs(zblassob))/sum(abs(zboltb))
s
model_a <- step(model_null, scope = list(lower = model_null, upper=full_3), direction = "both")
coef <- round(summary(model_a)$coefficients,2)
summary(model_a)
ad_r_sq_ma <- summary(model_a)$adj.r.squared
aic_ma <- AIC(model_a)
par(mfrow=c(1,1))
model_a <- step(model_null, scope = list(lower = model_null, upper=full_2), direction = "both")
coef <- round(summary(model_a)$coefficients,2)
summary(model_a)
ad_r_sq_ma <- summary(model_a)$adj.r.squared
aic_ma <- AIC(model_a)
par(mfrow=c(1,1))
adj_r_square_full3
ad_r_sq_ma
#The best Adkusted R square is the one in full 3 (the closer to 1 the better)
aic_full3
aic_ma
predictions_ma <- predict(model_a,total_500_final_test)
Actual_Revenues<- total_500_final_test$Revenues
par(mfrow=c(2,2))
plot (Actual_Revenues, col = "blue")
plot (predictions_ma, col = "Red",main = "Model A")
#####################################
predictions_full3 <- predict(full_3,total_500_final_test)
plot (predictions_full3, col = "Red",main = "Full_3 model")
total_500_final$im_s_verylarge <- 0
k<-0
for(y in 1:105){
k <- verylarge[y]
for(i in 1:439){
total_500_final$im_s_verylarge[i] <- total_500_final$im_s_verylarge[i] + images_only_x[i,k]
}}
total_500_final$im_s_verylarge <- total_500_final$im_s_verylarge/length(verylarge)
for(i in 1:439){
if (total_500_final$im_s_verylarge[i] >1){
total_500_final$im_s_verylarge[i] <- 1 #they have images of this size
}else{
total_500_final$im_s_verylarge[i] <- 0 #they do not have images of this size
}
}
par(mfrow=c(1,1))
barplot(table(total_500_final$im_s_verylarge),col = "darkred", main="Very Large images 0:NO, 1:YES")
total_500_final$im_s_verylarge <- 0
k<-0
for(y in 1:48){
k <- verylarge[y]
for(i in 1:408){
total_500_final$im_s_verylarge[i] <- total_500_final$im_s_verylarge[i] + images_only_x[i,k]
}}
total_500_final$im_s_verylarge <- total_500_final$im_s_verylarge/length(verylarge)
for(i in 1:408){
if (total_500_final$im_s_verylarge[i] >1){
total_500_final$im_s_verylarge[i] <- 1 #they have images of this size
}else{
total_500_final$im_s_verylarge[i] <- 0 #they do not have images of this size
}
}
par(mfrow=c(1,1))
barplot(table(total_500_final$im_s_verylarge),col = "darkred", main="Very Large images 0:NO, 1:YES")
for(i in 1:693){
x <- names(images_only_x)[i]
x2 <- strsplit(x, "X")
x3 <- x2[[1]]
x4 <- strsplit(x3[2], "x")
x5 <- x4[[1]]
a <- x5[1]
b <- x5[2]
a <- as.numeric(a)
b <- as.numeric(b)
if (a >= 800 | b >=800){
verylarge <- union(verylarge, c(i))
}else if((a >= 500 | b >=500) && (a < 800 | b < 800)){
large <- union(large, c(i))
}else if((a >=300 | b>=300) && (a < 500 | b < 500)){
medium <- union(medium, c(i))
}else if((a >= 100 | b>=100) && (a < 300 | b < 300)){
small <- union(small, c(i))
}else {
thumb <- union(thumb, c(i))
}
}
names(images_only_x)
i=1
x <- names(images_only_x)[i]
x2 <- strsplit(x, "X")
x3 <- x2[[1]]
x4 <- strsplit(x3[2], "x")
x5 <- x4[[1]]
a <- x5[1]
b <- x5[2]
a <- as.numeric(a)
b <- as.numeric(b)
if (a >= 800 | b >=800){
verylarge <- union(verylarge, c(i))
}else if((a >= 500 | b >=500) && (a < 800 | b < 800)){
large <- union(large, c(i))
}else if((a >=300 | b>=300) && (a < 500 | b < 500)){
medium <- union(medium, c(i))
}else if((a >= 100 | b>=100) && (a < 300 | b < 300)){
small <- union(small, c(i))
}else {
thumb <- union(thumb, c(i))
}
verylarge <- c()
large <- c()
medium <- c()
small <- c()
thumb <- c()
par(mfrow=c(3,3))
images_t <- total_500_final[,c(24:716)]
#names(images_t)
images_only_x <- images_t
for(i in 1:693){
names(images_only_x)[i] <- gsub("px", "", names(images_only_x)[i])
names(images_only_x)[i] <- gsub(".r.n", "", names(images_only_x)[i])
names(images_only_x)[i] <- gsub("auto", "X0", names(images_only_x)[i])
names(images_only_x)[i] <- gsub("\\.", "0", names(images_only_x)[i])
}
names(images_only_x)
images_only_x$x<- NULL
i=1
x <- names(images_only_x)[i]
x2 <- strsplit(x, "X")
x3 <- x2[[1]]
x4 <- strsplit(x3[2], "x")
x5 <- x4[[1]]
a <- x5[1]
b <- x5[2]
a <- as.numeric(a)
b <- as.numeric(b)
if (a >= 800 | b >=800){
verylarge <- union(verylarge, c(i))
}else if((a >= 500 | b >=500) && (a < 800 | b < 800)){
large <- union(large, c(i))
}else if((a >=300 | b>=300) && (a < 500 | b < 500)){
medium <- union(medium, c(i))
}else if((a >= 100 | b>=100) && (a < 300 | b < 300)){
small <- union(small, c(i))
}else {
thumb <- union(thumb, c(i))
}
}
i=1
x <- names(images_only_x)[i]
x2 <- strsplit(x, "X")
x3 <- x2[[1]]
x4 <- strsplit(x3[2], "x")
x5 <- x4[[1]]
a <- x5[1]
b <- x5[2]
a <- as.numeric(a)
b <- as.numeric(b)
if (a >= 800 | b >=800){
verylarge <- union(verylarge, c(i))
}else if((a >= 500 | b >=500) && (a < 800 | b < 800)){
large <- union(large, c(i))
}else if((a >=300 | b>=300) && (a < 500 | b < 500)){
medium <- union(medium, c(i))
}else if((a >= 100 | b>=100) && (a < 300 | b < 300)){
small <- union(small, c(i))
}else {
thumb <- union(thumb, c(i))
}
verylarge <- c()
large <- c()
medium <- c()
small <- c()
thumb <- c()
par(mfrow=c(3,3))
images_t <- total_500_final[,c(24:716)]
#names(images_t)
images_only_x <- images_t
for(i in 1:693){
names(images_only_x)[i] <- gsub("px", "", names(images_only_x)[i])
names(images_only_x)[i] <- gsub(".r.n", "", names(images_only_x)[i])
names(images_only_x)[i] <- gsub("auto", "X0", names(images_only_x)[i])
names(images_only_x)[i] <- gsub("\\.", "0", names(images_only_x)[i])
}
images_only_x$x<- NULL
i=1
x <- names(images_only_x)[i]
x2 <- strsplit(x, "X")
x3 <- x2[[1]]
x4 <- strsplit(x3[2], "x")
x5 <- x4[[1]]
a <- x5[1]
b <- x5[2]
a <- as.numeric(a)
b <- as.numeric(b)
if (a >= 800 | b >=800){
verylarge <- union(verylarge, c(i))
}else if((a >= 500 | b >=500) && (a < 800 | b < 800)){
large <- union(large, c(i))
}else if((a >=300 | b>=300) && (a < 500 | b < 500)){
medium <- union(medium, c(i))
}else if((a >= 100 | b>=100) && (a < 300 | b < 300)){
small <- union(small, c(i))
}else if(a < 100 | b < 100){
thumb <- union(thumb, c(i))
}
i=2
x <- names(images_only_x)[i]
x2 <- strsplit(x, "X")
x3 <- x2[[1]]
x4 <- strsplit(x3[2], "x")
x5 <- x4[[1]]
a <- x5[1]
b <- x5[2]
a <- as.numeric(a)
b <- as.numeric(b)
if (a >= 800 | b >=800){
verylarge <- union(verylarge, c(i))
}else if((a >= 500 | b >=500) && (a < 800 | b < 800)){
large <- union(large, c(i))
}else if((a >=300 | b>=300) && (a < 500 | b < 500)){
medium <- union(medium, c(i))
}else if((a >= 100 | b>=100) && (a < 300 | b < 300)){
small <- union(small, c(i))
}else if(a < 100 | b < 100){
thumb <- union(thumb, c(i))
}
}
verylarge <- c()
large <- c()
medium <- c()
small <- c()
thumb <- c()
par(mfrow=c(3,3))
images_t <- total_500_final[,c(24:716)]
#names(images_t)
images_only_x <- images_t
for(i in 1:693){
names(images_only_x)[i] <- gsub("px", "", names(images_only_x)[i])
names(images_only_x)[i] <- gsub(".r.n", "", names(images_only_x)[i])
names(images_only_x)[i] <- gsub("auto", "X0", names(images_only_x)[i])
names(images_only_x)[i] <- gsub("\\.", "0", names(images_only_x)[i])
}
names(images_only_x)
images_only_x$x<- NULL
for(i in 1:693){
x <- names(images_only_x)[i]
x2 <- strsplit(x, "X")
x3 <- x2[[1]]
x4 <- strsplit(x3[2], "x")
x5 <- x4[[1]]
a <- x5[1]
b <- x5[2]
a <- as.numeric(a)
b <- as.numeric(b)
if (a >= 800 | b >=800){
verylarge <- union(verylarge, c(i))
}else if((a >= 500 | b >=500) && (a < 800 | b < 800)){
large <- union(large, c(i))
}else if((a >=300 | b>=300) && (a < 500 | b < 500)){
medium <- union(medium, c(i))
}else if((a >= 100 | b>=100) && (a < 300 | b < 300)){
small <- union(small, c(i))
}else if(a < 100 | b < 100){
thumb <- union(thumb, c(i))
}
}
names(images_only_x)
verylarge <- c()
large <- c()
medium <- c()
small <- c()
thumb <- c()
par(mfrow=c(3,3))
images_t <- total_500_final[,c(24:716)]
#names(images_t)
images_only_x <- images_t
for(i in 1:693){
names(images_only_x)[i] <- gsub("px", "", names(images_only_x)[i])
names(images_only_x)[i] <- gsub(".r.n", "", names(images_only_x)[i])
names(images_only_x)[i] <- gsub("auto", "X0", names(images_only_x)[i])
names(images_only_x)[i] <- gsub("\\.", "0", names(images_only_x)[i])
}
names(images_only_x)
images_only_x$x<- NULL
for(i in 1:693){
x <- names(images_only_x)[i]
x2 <- strsplit(x, "X")
x3 <- x2[[1]]
x4 <- strsplit(x3[2], "x")
x5 <- x4[[1]]
a <- x5[1]
b <- x5[2]
a <- as.numeric(a)
b <- as.numeric(b)
if (a >= 800 | b >= 800){
verylarge <- union(verylarge, c(i))
}else if((a >= 500 | b >=500) && (a < 800 | b < 800)){
large <- union(large, c(i))
}else if((a >=300 | b>=300) && (a < 500 | b < 500)){
medium <- union(medium, c(i))
}else if((a >= 100 | b>=100) && (a < 300 | b < 300)){
small <- union(small, c(i))
}else if(a < 100 | b < 100){
thumb <- union(thumb, c(i))
}
}
total_500_final$im_s_verylarge <- 0
k<-0
for(y in 1:48){
k <- verylarge[y]
for(i in 1:408){
if i == k {
total_500_final$im_s_verylarge[i] <- total_500_final$im_s_verylarge[i] + images_only_x[i,k]
}
}
}
verylarge <- c()
large <- c()
medium <- c()
small <- c()
thumb <- c()
par(mfrow=c(3,3))
images_t <- total_500_final[,c(24:716)]
#names(images_t)
images_only_x <- images_t
for(i in 1:693){
names(images_only_x)[i] <- gsub("px", "", names(images_only_x)[i])
names(images_only_x)[i] <- gsub(".r.n", "", names(images_only_x)[i])
names(images_only_x)[i] <- gsub("auto", "X0", names(images_only_x)[i])
names(images_only_x)[i] <- gsub("\\.", "0", names(images_only_x)[i])
}
names(images_only_x)
images_only_x$x<- NULL
for(i in 1:693){
x <- names(images_only_x)[i]
x2 <- strsplit(x, "X")
x3 <- x2[[1]]
x4 <- strsplit(x3[2], "x")
x5 <- x4[[1]]
a <- x5[1]
b <- x5[2]
a <- as.numeric(a)
b <- as.numeric(b)
if (a >= 800 | b >= 800){
verylarge <- union(verylarge, c(i))
}else if((a >= 500 | b >=500) && (a < 800 | b < 800)){
large <- union(large, c(i))
}else if((a >=300 | b>=300) && (a < 500 | b < 500)){
medium <- union(medium, c(i))
}else if((a >= 100 | b>=100) && (a < 300 | b < 300)){
small <- union(small, c(i))
}else if(a < 100 | b < 100){
thumb <- union(thumb, c(i))
}
}}
verylarge <- c()
large <- c()
medium <- c()
small <- c()
thumb <- c()
par(mfrow=c(3,3))
images_t <- total_500_final[,c(24:716)]
#names(images_t)
images_only_x <- images_t
for(i in 1:693){
names(images_only_x)[i] <- gsub("px", "", names(images_only_x)[i])
names(images_only_x)[i] <- gsub(".r.n", "", names(images_only_x)[i])
names(images_only_x)[i] <- gsub("auto", "X0", names(images_only_x)[i])
names(images_only_x)[i] <- gsub("\\.", "0", names(images_only_x)[i])
}
names(images_only_x)
images_only_x$x<- NULL
for(i in 1:693){
x <- names(images_only_x)[i]
x2 <- strsplit(x, "X")
x3 <- x2[[1]]
x4 <- strsplit(x3[2], "x")
x5 <- x4[[1]]
a <- x5[1]
b <- x5[2]
a <- as.numeric(a)
b <- as.numeric(b)
if (a >= 800 | b >= 800){
verylarge <- union(verylarge, c(i))
}else if((a >= 500 | b >=500) && (a < 800 | b < 800)){
large <- union(large, c(i))
}else if((a >=300 | b>=300) && (a < 500 | b < 500)){
medium <- union(medium, c(i))
}else if((a >= 100 | b>=100) && (a < 300 | b < 300)){
small <- union(small, c(i))
}else if(a < 100 | b < 100){
thumb <- union(thumb, c(i))
}
}
total_500_final$im_s_verylarge <- 0
k<-0
for(y in 1:48){
k <- verylarge[y]
for(i in 1:408){
if i == k {
total_500_final$im_s_verylarge[i] <- total_500_final$im_s_verylarge[i] + images_only_x[i,k]
}}
}
verylarge <- c()
large <- c()
medium <- c()
small <- c()
thumb <- c()
par(mfrow=c(3,3))
images_t <- total_500_final[,c(24:716)]
#names(images_t)
images_only_x <- images_t
for(i in 1:693){
names(images_only_x)[i] <- gsub("px", "", names(images_only_x)[i])
names(images_only_x)[i] <- gsub(".r.n", "", names(images_only_x)[i])
names(images_only_x)[i] <- gsub("auto", "X0", names(images_only_x)[i])
names(images_only_x)[i] <- gsub("\\.", "0", names(images_only_x)[i])
}
names(images_only_x)
images_only_x$x<- NULL
for(i in 1:693){
x <- names(images_only_x)[i]
x2 <- strsplit(x, "X")
x3 <- x2[[1]]
x4 <- strsplit(x3[2], "x")
x5 <- x4[[1]]
a <- x5[1]
b <- x5[2]
a <- as.numeric(a)
b <- as.numeric(b)
if (a >= 800 | b >= 800){
verylarge <- union(verylarge, c(i))
}else if((a >= 500 | b >=500) && (a < 800 | b < 800)){
large <- union(large, c(i))
}else if((a >=300 | b>=300) && (a < 500 | b < 500)){
medium <- union(medium, c(i))
}else if((a >= 100 | b>=100) && (a < 300 | b < 300)){
small <- union(small, c(i))
}else if(a < 100 | b < 100){
thumb <- union(thumb, c(i))
}
}
#######################################
total_500_final$im_s_verylarge <- 0
k<-0
for(y in 1:48){
k <- verylarge[y]
for(i in 1:408){
total_500_final$im_s_verylarge[i] <- total_500_final$im_s_verylarge[i] + images_only_x[i,k]
}
}
total_500_final$im_s_verylarge <- total_500_final$im_s_verylarge/length(verylarge)
for(i in 1:408){
if (total_500_final$im_s_verylarge[i] >1){
total_500_final$im_s_verylarge[i] <- 1 #they have images of this size
}else{
total_500_final$im_s_verylarge[i] <- 0 #they do not have images of this size
}
}
par(mfrow=c(1,1))
barplot(table(total_500_final$im_s_verylarge),col = "darkred", main="Very Large images 0:NO, 1:YES")
total_500_final$im_s_large <- 0
for(y in 1:26){
k <- large[y]
for(i in 1:408){
total_500_final$im_s_large[i] <- total_500_final$im_s_large[i] + images_only_x[i,k]
}}
total_500_final$im_s_large <- total_500_final$im_s_large/length(large)
for(i in 1:408){
if (total_500_final$im_s_large[i] >1){
total_500_final$im_s_large[i] <- 1
}else{
total_500_final$im_s_large[i] <- 0 #they do not have images of this size
}
}
par(mfrow=c(1,1))
barplot(table(total_500_final$im_s_large),col = "darkblue", main="Large images 0:NO, 1:YES")
total_500_final$im_s_medium <- 0
for(y in 1:18){
k <- medium[y]
for(i in 1:408){
total_500_final$im_s_medium[i] <- total_500_final$im_s_medium[i] + images_only_x[i,k]
}}
total_500_final$im_s_medium <- total_500_final$im_s_medium/length(medium)
for(i in 1:408){
if (total_500_final$im_s_medium[i] >1){
total_500_final$im_s_medium[i] <- 1
}else{
total_500_final$im_s_medium[i] <- 0 #they do not have images of this size
}
}
par(mfrow=c(1,1))
barplot(table(total_500_final$im_s_medium),col = "darkgreen", main="Medium images 0:NO, 1:YES")
total_500_final$im_s_small <- 0
for(y in 1:81){
k <- small[y]
for(i in 1:408){
total_500_final$im_s_small[i] <- total_500_final$im_s_small[i] + images_only_x[i,k]
}}
total_500_final$im_s_small <- total_500_final$im_s_small/length(small)
for(i in 1:408){
if (total_500_final$im_s_small[i] >1){
total_500_final$im_s_small[i] <- 1
}else{
total_500_final$im_s_small[i] <- 0 #they do not have images of this size
}
}
par(mfrow=c(1,1))
barplot(table(total_500_final$im_s_small),col = "red", main="Small images 0:NO, 1:YES")
